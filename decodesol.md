# Solution to decode
以下说明中 $n=randmax$
## 20pts
解密的过程其实就是求通过$R$求出$y$然后$xor$回去的过程。。
直接快速幂模拟就行。
时间$O(Tnlogk)$
## 30pts
套公式。注意取模问题。
$$\sum_{i=1}^ni^2=\frac{n(n+1)(2n+1)}{6}$$
时间$O(T)$
## 40pts
继续套公式。同样注意取模问题。
$$\sum_{i=1}^ni^3=(\sum_{i=1}^ni)^2$$
时间$O(T)$
## 60pts
主要数据范围1e9，自然只有考虑$O(logn)$或者$O(1)$算法。
emm题目在联赛范围内。。。
那么考虑矩阵快速幂
那么代表我们要求出递推式。
由二项式定理，有
$$(x+1)^k=\sum_{i=0}C^i_kx^i$$
由此构造矩阵，以$k=4$为例
$$
\left(
\begin{matrix}
1 & 1 & 0 & 0 & 0\\
0 & 1 & 3 & 3 & 1\\
0 & 0 & 1 & 2 & 1\\
0 & 0 & 0 & 1 & 1\\
0 & 0 & 0 & 0 & 1
\end{matrix}
\right)
$$
列向量意义为
$$
\left(
\begin{matrix}
sum\\
x^3\\
x^2\\
x\\
1
\end{matrix}
\right)
$$
没错，就是往矩阵里填了个杨辉三角。。
其中$sum$即为所求。
复杂度$O(Tk^3logn)$
Warning！千万注意只这样写前20pts会T的
想拿60pts还要分开搞
## 80pts
这部分模数固定为质数，因此一定有模逆元，可以用一般数学方法做。
由**差分序列**可知$\sum_{i=1}^{R}i^k$为关于R的$k+1$次多项式
求出前$k+2$个点值然后高斯消元或者其他黑科技(详见Codeforces 622F)
如果不知道差分序列是啥可以自行百度
复杂度$O(k^3)$或更优。
## 100pts
这里不是任意模数，不一定有逆元，80pts的方法失效了。
所以这部分是由60pts方法优化而来。用同样的方法构造矩阵。
但是注意到，每次的$k$都是固定的。因此我们可以预处理出
转移矩阵的$2^d(d\in N)$次幂存下来。
这样做有什么好处呢？与现用现算有什么区别呢？
我们注意到，列向量矩阵中只有一列是有值的。
所以每次*转移矩阵*×*列向量矩阵*都能省掉一维枚举，矩阵乘法时间变为$O(n^2)$。
而不能这样优化的*转移矩阵*×*转移矩阵*运算，我们已经预处理好了。

最终复杂度：
时间$O(k^ 3logn+Tk ^ 2logn)$
空间$O(k^2logn)$

欢迎提供更好做法。

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTc4NTEwMjg1Nl19
-->